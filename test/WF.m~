function f=WF(omega,Lambda,epsilon,x,Yp) % the integrand of delta_W, omega is imaginary number normalized to vth/R0. vth=sqrt(2Th/M)
g=0.0;
n=1;
p=-1:1;
np=length(p);
for j=1:np
    g=g+abs(Yp(j,:,:))^2/...
    (n*omega_phi(Lambda,epsilon,x)+...
     p(j)*omega_b(Lambda,epsilon,x)-omega);
end
f=Jac(x)/qprofile(x)*epsilon^3*density(x)*...
    pFpE(Lambda,epsilon)*...
  2*pi/omega_b(Lambda,epsilon,x)*...
  (omega-omega_star(epsilon,x))*g;    
end
